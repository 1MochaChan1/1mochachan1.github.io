---
import type { CollectionEntry } from "astro:content";

interface Props {
  game: CollectionEntry<"games">;
  neonColor?: "pink" | "blue" | "white";
}

const { game, neonColor = "pink" } = Astro.props;
const { title, cover, tags, status } = game.data;
// Ensure we link to the clean slug (remove file extension if present)
const slug = typeof game.id === 'string' ? game.id.replace(/\.md$/, '') : String(game.id);

// Border color classes
const borderClasses = {
  pink: "border-[#ff2a6d]",
  blue: "border-[#05d9e8]",
  white: "border-[#f0f0f0]"
};

// Glow shadow styles
const glowStyles = {
  pink: `
    0 0 5px #ff2a6d,
    0 0 10px #ff2a6d,
    0 0 20px rgba(255, 42, 109, 0.5),
    0 0 40px rgba(255, 42, 109, 0.3),
    inset 0 0 15px rgba(255, 42, 109, 0.15)
  `,
  blue: `
    0 0 5px #05d9e8,
    0 0 10px #05d9e8,
    0 0 20px rgba(5, 217, 232, 0.5),
    0 0 40px rgba(5, 217, 232, 0.3),
    inset 0 0 15px rgba(5, 217, 232, 0.15)
  `,
  white: `
    0 0 5px rgba(240, 240, 240, 0.8),
    0 0 10px rgba(240, 240, 240, 0.6),
    0 0 20px rgba(240, 240, 240, 0.4),
    0 0 40px rgba(240, 240, 240, 0.2),
    inset 0 0 15px rgba(240, 240, 240, 0.1)
  `
};

const titleGlowClasses = {
  pink: "neon-pink",
  blue: "neon-blue", 
  white: "neon-white"
};
---

<a href={`/games/${slug}`} class="game-card-link group block">
  <article 
    class={`game-card relative rounded-lg overflow-hidden border-4 ${borderClasses[neonColor]} bg-black/70`}
    style={`box-shadow: ${glowStyles[neonColor]};`}
  >
    <!-- Cover Image -->
    <div class="card-image relative w-full overflow-hidden bg-gradient-to-br from-[#0d0d1a] to-[#1a1a2e]">
      <img
        src={cover}
        alt={title}
        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
        loading="lazy"
      />
    </div>

    <!-- Title Section -->
    <div class={`card-title p-3 bg-black/80 text-center border-t-2 ${borderClasses[neonColor]}`}>
      <h3 class={`text-xs font-pixel uppercase leading-relaxed ${titleGlowClasses[neonColor]}`}>
        {title}
      </h3>
    </div>
  </article>
</a>

<style>
  .game-card-link {
    display: block;
    text-decoration: none;
    transition: transform 0.4s ease, filter 0.4s ease;
    will-change: transform, filter;
    width: 100%;
    height: 200px;
  }

  .game-card {
    height: 100%;
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.4s ease;
  }

  .card-image {
    flex: 1;
    min-height: 0;
  }

  .card-title {
    flex-shrink: 0;
  }

  .game-card-link:hover {
    transform: scale(1.03);
    filter: brightness(1.1);
  }

  .game-card-link:focus-visible {
    outline: 2px solid #05d9e8;
    outline-offset: 4px;
    border-radius: 8px;
  }

  .game-card {
    transition: box-shadow 0.4s ease;
  }

  .game-card-link:hover .game-card {
    box-shadow: 
      0 0 10px currentColor,
      0 0 20px currentColor,
      0 0 40px currentColor,
      0 0 60px rgba(255, 255, 255, 0.2);
  }
</style>
